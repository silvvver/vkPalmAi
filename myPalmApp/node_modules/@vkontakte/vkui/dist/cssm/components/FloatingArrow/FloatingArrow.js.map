{"version":3,"sources":["../../../../src/components/FloatingArrow/FloatingArrow.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport type { Placement } from '../../lib/floating';\nimport type { HasDataAttribute, HTMLAttributesWithRootRef } from '../../types';\nimport { RootComponent } from '../RootComponent/RootComponent';\nimport { DefaultIcon } from './DefaultIcon';\nimport styles from './FloatingArrow.module.css';\n\nexport type Coords = {\n  /** Координата x. */\n  x?: number;\n  /** Координата y. */\n  y?: number;\n};\n\nexport const placementClassNames = {\n  right: styles.placementRight,\n  bottom: styles.placementBottom,\n  left: styles.placementLeft,\n};\n\nexport interface FloatingArrowProps\n  extends HTMLAttributesWithRootRef<HTMLDivElement>,\n    HasDataAttribute {\n  /**\n   * Сдвиг стрелки относительно текущих координат.\n   */\n  offset?: number;\n  /**\n   * Включает абсолютное смещение по `offset`.\n   */\n  isStaticOffset?: boolean;\n  /**\n   * Координаты стрелки.\n   */\n  coords?: Coords;\n  /**\n   * Расположение всплывающего элемента.\n   */\n  placement?: Placement;\n  /**\n   * Стили иконки.\n   */\n  iconStyle?: React.CSSProperties;\n  /**\n   * `className` для иконки.\n   */\n  iconClassName?: string;\n  /**\n   * Иконка для отображения стрелки.\n   */\n  Icon?: React.ComponentType<React.SVGAttributes<SVGSVGElement>>;\n}\n\n/**\n * Иконка-стрелка для всплывающих окон.\n *\n * @since 7.0.0\n */\nexport const FloatingArrow = ({\n  offset,\n  isStaticOffset,\n  coords,\n  iconStyle,\n  iconClassName,\n  placement = 'bottom',\n  Icon = DefaultIcon,\n  ...restProps\n}: FloatingArrowProps): React.ReactNode => {\n  const [arrowPlacement, arrowStyles] = getArrowPositionData(\n    placement,\n    coords,\n    offset,\n    isStaticOffset,\n  );\n\n  return (\n    <RootComponent\n      baseStyle={arrowStyles}\n      baseClassName={classNames(styles.host, arrowPlacement && placementClassNames[arrowPlacement])}\n      {...restProps}\n    >\n      <Icon className={classNames(styles.in, iconClassName)} style={iconStyle} />\n    </RootComponent>\n  );\n};\n\nfunction getArrowPositionData(\n  placement: Placement,\n  coords: Coords = { x: 0, y: 0 },\n  offset = 0,\n  isStaticOffset = false,\n): [undefined | 'right' | 'bottom' | 'left', React.CSSProperties] {\n  const withOffset = (isVerticalPlacement: boolean) => {\n    const parsedCoords = { x: coords.x || 0, y: coords.y || 0 };\n\n    if (isVerticalPlacement) {\n      return isStaticOffset ? offset : parsedCoords.y + offset;\n    } else {\n      return isStaticOffset ? offset : parsedCoords.x + offset;\n    }\n  };\n\n  if (placement.startsWith('top')) {\n    const xOffsetProp = getXOffsetProp(placement, isStaticOffset);\n    return [\n      'bottom',\n      {\n        top: '100%',\n        [xOffsetProp]: withOffset(false),\n      },\n    ];\n  } else if (placement.startsWith('right')) {\n    const yOffsetProp = getYOffsetProp(placement, isStaticOffset);\n    return [\n      'left',\n      {\n        [yOffsetProp]: withOffset(true),\n        left: 0,\n      },\n    ];\n  } else if (placement.startsWith('bottom')) {\n    const xOffsetProp = getXOffsetProp(placement, isStaticOffset);\n    return [\n      undefined,\n      {\n        bottom: '100%',\n        [xOffsetProp]: withOffset(false),\n      },\n    ];\n  } else {\n    const yOffsetProp = getYOffsetProp(placement, isStaticOffset);\n    return [\n      'right',\n      {\n        [yOffsetProp]: withOffset(true),\n        right: 0,\n      },\n    ];\n  }\n}\n\nfunction getXOffsetProp(placement: Placement, isStaticOffset: boolean) {\n  return placement.endsWith('end') && isStaticOffset ? 'right' : 'left';\n}\n\nfunction getYOffsetProp(placement: Placement, isStaticOffset: boolean) {\n  return placement.endsWith('end') && isStaticOffset ? 'bottom' : 'top';\n}\n"],"names":["React","classNames","RootComponent","DefaultIcon","styles","placementClassNames","right","placementRight","bottom","placementBottom","left","placementLeft","FloatingArrow","offset","isStaticOffset","coords","iconStyle","iconClassName","placement","Icon","restProps","arrowPlacement","arrowStyles","getArrowPositionData","baseStyle","baseClassName","host","className","in","style","x","y","withOffset","isVerticalPlacement","parsedCoords","startsWith","xOffsetProp","getXOffsetProp","top","yOffsetProp","getYOffsetProp","undefined","endsWith"],"mappings":";AAAA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,UAAU,QAAQ,kBAAkB;AAG7C,SAASC,aAAa,QAAQ,oCAAiC;AAC/D,SAASC,WAAW,QAAQ,mBAAgB;AAC5C,OAAOC,YAAY,6BAA6B;AAShD,OAAO,MAAMC,sBAAsB;IACjCC,OAAOF,OAAOG,cAAc;IAC5BC,QAAQJ,OAAOK,eAAe;IAC9BC,MAAMN,OAAOO,aAAa;AAC5B,EAAE;AAmCF;;;;CAIC,GACD,OAAO,MAAMC,gBAAgB,CAAC,EAC5BC,MAAM,EACNC,cAAc,EACdC,MAAM,EACNC,SAAS,EACTC,aAAa,EACbC,YAAY,QAAQ,EACpBC,OAAOhB,WAAW,EAClB,GAAGiB,WACgB;IACnB,MAAM,CAACC,gBAAgBC,YAAY,GAAGC,qBACpCL,WACAH,QACAF,QACAC;IAGF,qBACE,KAACZ;QACCsB,WAAWF;QACXG,eAAexB,WAAWG,OAAOsB,IAAI,EAAEL,kBAAkBhB,mBAAmB,CAACgB,eAAe;QAC3F,GAAGD,SAAS;kBAEb,cAAA,KAACD;YAAKQ,WAAW1B,WAAWG,OAAOwB,EAAE,EAAEX;YAAgBY,OAAOb;;;AAGpE,EAAE;AAEF,SAASO,qBACPL,SAAoB,EACpBH,SAAiB;IAAEe,GAAG;IAAGC,GAAG;AAAE,CAAC,EAC/BlB,SAAS,CAAC,EACVC,iBAAiB,KAAK;IAEtB,MAAMkB,aAAa,CAACC;QAClB,MAAMC,eAAe;YAAEJ,GAAGf,OAAOe,CAAC,IAAI;YAAGC,GAAGhB,OAAOgB,CAAC,IAAI;QAAE;QAE1D,IAAIE,qBAAqB;YACvB,OAAOnB,iBAAiBD,SAASqB,aAAaH,CAAC,GAAGlB;QACpD,OAAO;YACL,OAAOC,iBAAiBD,SAASqB,aAAaJ,CAAC,GAAGjB;QACpD;IACF;IAEA,IAAIK,UAAUiB,UAAU,CAAC,QAAQ;QAC/B,MAAMC,cAAcC,eAAenB,WAAWJ;QAC9C,OAAO;YACL;YACA;gBACEwB,KAAK;gBACL,CAACF,YAAY,EAAEJ,WAAW;YAC5B;SACD;IACH,OAAO,IAAId,UAAUiB,UAAU,CAAC,UAAU;QACxC,MAAMI,cAAcC,eAAetB,WAAWJ;QAC9C,OAAO;YACL;YACA;gBACE,CAACyB,YAAY,EAAEP,WAAW;gBAC1BtB,MAAM;YACR;SACD;IACH,OAAO,IAAIQ,UAAUiB,UAAU,CAAC,WAAW;QACzC,MAAMC,cAAcC,eAAenB,WAAWJ;QAC9C,OAAO;YACL2B;YACA;gBACEjC,QAAQ;gBACR,CAAC4B,YAAY,EAAEJ,WAAW;YAC5B;SACD;IACH,OAAO;QACL,MAAMO,cAAcC,eAAetB,WAAWJ;QAC9C,OAAO;YACL;YACA;gBACE,CAACyB,YAAY,EAAEP,WAAW;gBAC1B1B,OAAO;YACT;SACD;IACH;AACF;AAEA,SAAS+B,eAAenB,SAAoB,EAAEJ,cAAuB;IACnE,OAAOI,UAAUwB,QAAQ,CAAC,UAAU5B,iBAAiB,UAAU;AACjE;AAEA,SAAS0B,eAAetB,SAAoB,EAAEJ,cAAuB;IACnE,OAAOI,UAAUwB,QAAQ,CAAC,UAAU5B,iBAAiB,WAAW;AAClE"}