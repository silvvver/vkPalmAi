{"version":3,"sources":["../../../../src/components/CalendarDay/CalendarDay.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useFocusVisible } from '../../hooks/useFocusVisible';\nimport { useFocusVisibleClassName } from '../../hooks/useFocusVisibleClassName';\nimport { mergeCalls } from '../../lib/mergeCalls';\nimport { defineComponentDisplayNames } from '../../lib/react/defineComponentDisplayNames';\nimport { useConfigProvider } from '../ConfigProvider/ConfigProviderContext';\nimport { Tappable } from '../Tappable/Tappable';\nimport { VisuallyHidden } from '../VisuallyHidden/VisuallyHidden';\nimport styles from './CalendarDay.module.css';\n\nexport type CalendarDayElementProps = Omit<\n  React.AllHTMLAttributes<HTMLElement>,\n  'onChange' | 'size' | 'disabled' | 'selected' | 'onFocus'\n>;\n\nexport type CalendarDayTestsProps = {\n  /**\n   * Передает атрибут `data-testid` для дня в календаре.\n   */\n  testId?: string | ((day: Date) => string);\n};\n\nexport interface CalendarDayProps extends CalendarDayElementProps, CalendarDayTestsProps {\n  /**\n   * Дата, которую представляет этот день.\n   */\n  day: Date;\n  /**\n   * Является ли день сегодняшним.\n   */\n  today?: boolean;\n  /**\n   * Выбран ли день (в режиме одиночного выбора или как часть диапазона).\n   */\n  selected?: boolean;\n  /**\n   * Является ли день началом выделенного диапазона.\n   */\n  selectionStart?: boolean;\n  /**\n   * Является ли день концом выделенного диапазона.\n   */\n  selectionEnd?: boolean;\n  /**\n   * Подсветить день как начало предполагаемого диапазона (при наведении).\n   */\n  hintedSelectionStart?: boolean;\n  /**\n   * Подсветить день как конец предполагаемого диапазона (при наведении).\n   */\n  hintedSelectionEnd?: boolean;\n  /**\n   * Активен ли день (текущая дата в календаре).\n   */\n  active?: boolean;\n  /**\n   * Скрыть день (например, дни соседних месяцев).\n   */\n  hidden?: boolean;\n  /**\n   * Блокировка взаимодействия с компонентом.\n   */\n  disabled?: boolean;\n  /**\n   * Находится ли день в фокусе (клавиатурная навигация).\n   */\n  focused?: boolean;\n  /**\n   * Подсвечен ли день (ховер).\n   */\n  hinted?: boolean;\n  /**\n   * Принадлежит ли день текущему отображаемому месяцу.\n   */\n  sameMonth?: boolean;\n  /**\n   * Размер компонента.\n   */\n  size?: 's' | 'm';\n  /**\n   * Обработчик выбора/изменения дня.\n   */\n  onChange: (value: Date) => void;\n  /**\n   * Обработчик наведения на день.\n   */\n  onEnter?: (value: Date) => void;\n  /**\n   * Обработчик снятия ховера с дня.\n   */\n  onLeave?: (value: Date) => void;\n  /**\n   * Обработчик фокуса на дне.\n   */\n  onFocus?: (value: Date) => void;\n  /**\n   * Кастомизация отображения содержимого дня.\n   */\n  renderDayContent?: (day: Date) => React.ReactNode;\n}\n\n// eslint-disable-next-line react/display-name -- используется defineComponentDisplayNames\nexport const CalendarDay = React.memo(\n  ({\n    day,\n    today,\n    selected,\n    onChange,\n    hidden,\n    disabled,\n    active,\n    selectionStart,\n    selectionEnd,\n    focused,\n    onEnter,\n    onLeave,\n    onFocus,\n    onBlur,\n    hinted,\n    hintedSelectionStart,\n    hintedSelectionEnd,\n    sameMonth,\n    size,\n    children,\n    renderDayContent,\n    testId,\n    role,\n    'aria-colindex': colIndex,\n    ...restProps\n  }: CalendarDayProps) => {\n    const { locale, direction } = useConfigProvider();\n    const ref = React.useRef<HTMLElement>(null);\n    const onClick = React.useCallback(() => onChange(day), [day, onChange]);\n    const handleEnter = React.useCallback(() => onEnter?.(day), [day, onEnter]);\n    const handleLeave = React.useCallback(() => onLeave?.(day), [day, onLeave]);\n    const handleFocus = React.useCallback(() => onFocus?.(day), [day, onFocus]);\n\n    const focusVisibleMode = active ? 'outside' : 'inside';\n    const { focusVisible, ...focusEvents } = useFocusVisible();\n    const focusVisibleClassNames = useFocusVisibleClassName({\n      focusVisible,\n      mode: focusVisibleMode,\n    });\n    const focusHandlers = mergeCalls(focusEvents, { onFocus: handleFocus, onBlur });\n\n    const label = new Intl.DateTimeFormat(locale, {\n      weekday: 'long',\n      month: 'long',\n      day: 'numeric',\n    }).format(day);\n\n    React.useEffect(() => {\n      if (focused && ref.current) {\n        ref.current.focus();\n      }\n    }, [focused]);\n\n    const content = React.useMemo(() => {\n      if (renderDayContent) {\n        return renderDayContent(day);\n      }\n      return (\n        <div className={styles.dayNumber}>\n          <VisuallyHidden>{children ?? label}</VisuallyHidden>\n          <span aria-hidden>{day.getDate()}</span>\n        </div>\n      );\n    }, [renderDayContent, day, children, label]);\n\n    if (hidden) {\n      return (\n        <div\n          role={role}\n          aria-colindex={colIndex}\n          className={classNames(styles.hidden, size === 's' && styles.sizeS)}\n        />\n      );\n    }\n\n    return (\n      <Tappable\n        baseClassName={classNames(\n          styles.host,\n          size === 's' && styles.sizeS,\n          direction === 'rtl' && styles.rtl,\n          focusVisibleClassNames,\n        )}\n        role={role}\n        aria-colindex={colIndex}\n        hoverMode={styles.hostHovered}\n        activeMode={styles.hostActivated}\n        hasActive={false}\n        onClick={onClick}\n        disabled={disabled}\n        getRootRef={ref}\n        onPointerEnter={handleEnter}\n        onPointerLeave={handleLeave}\n        data-testid={typeof testId === 'string' ? testId : testId?.(day)}\n        {...restProps}\n        {...focusHandlers}\n      >\n        <div\n          className={classNames(\n            styles.content,\n            size === 's' && styles.sizeS,\n            today && styles.today,\n            selected && !disabled && styles.selected,\n            selectionStart && styles.selectionStart,\n            selectionEnd && styles.selectionEnd,\n            disabled && styles.disabled,\n            !sameMonth && styles.notSameMonth,\n          )}\n        >\n          <div\n            className={classNames(\n              styles.hinted,\n              hinted && styles.hintedActive,\n              hintedSelectionStart && styles.hintedSelectionStart,\n              hintedSelectionEnd && styles.hintedSelectionEnd,\n            )}\n          >\n            <div className={classNames(styles.inner, active && !disabled && styles.innerActive)}>\n              {content}\n            </div>\n          </div>\n        </div>\n      </Tappable>\n    );\n  },\n);\n\nif (process.env.NODE_ENV !== 'production') {\n  defineComponentDisplayNames(CalendarDay, 'CalendarDay');\n}\n"],"names":["React","classNames","useFocusVisible","useFocusVisibleClassName","mergeCalls","defineComponentDisplayNames","useConfigProvider","Tappable","VisuallyHidden","styles","CalendarDay","memo","day","today","selected","onChange","hidden","disabled","active","selectionStart","selectionEnd","focused","onEnter","onLeave","onFocus","onBlur","hinted","hintedSelectionStart","hintedSelectionEnd","sameMonth","size","children","renderDayContent","testId","role","colIndex","restProps","locale","direction","ref","useRef","onClick","useCallback","handleEnter","handleLeave","handleFocus","focusVisibleMode","focusVisible","focusEvents","focusVisibleClassNames","mode","focusHandlers","label","Intl","DateTimeFormat","weekday","month","format","useEffect","current","focus","content","useMemo","div","className","dayNumber","span","aria-hidden","getDate","aria-colindex","sizeS","baseClassName","host","rtl","hoverMode","hostHovered","activeMode","hostActivated","hasActive","getRootRef","onPointerEnter","onPointerLeave","data-testid","notSameMonth","hintedActive","inner","innerActive","process","env","NODE_ENV"],"mappings":"AAAA;;AAEA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,UAAU,QAAQ,kBAAkB;AAC7C,SAASC,eAAe,QAAQ,iCAA8B;AAC9D,SAASC,wBAAwB,QAAQ,0CAAuC;AAChF,SAASC,UAAU,QAAQ,0BAAuB;AAClD,SAASC,2BAA2B,QAAQ,iDAA8C;AAC1F,SAASC,iBAAiB,QAAQ,6CAA0C;AAC5E,SAASC,QAAQ,QAAQ,0BAAuB;AAChD,SAASC,cAAc,QAAQ,sCAAmC;AAClE,OAAOC,YAAY,2BAA2B;AA6F9C,0FAA0F;AAC1F,OAAO,MAAMC,4BAAcV,MAAMW,IAAI,CACnC,CAAC,EACCC,GAAG,EACHC,KAAK,EACLC,QAAQ,EACRC,QAAQ,EACRC,MAAM,EACNC,QAAQ,EACRC,MAAM,EACNC,cAAc,EACdC,YAAY,EACZC,OAAO,EACPC,OAAO,EACPC,OAAO,EACPC,OAAO,EACPC,MAAM,EACNC,MAAM,EACNC,oBAAoB,EACpBC,kBAAkB,EAClBC,SAAS,EACTC,IAAI,EACJC,QAAQ,EACRC,gBAAgB,EAChBC,MAAM,EACNC,IAAI,EACJ,iBAAiBC,QAAQ,EACzB,GAAGC,WACc;IACjB,MAAM,EAAEC,MAAM,EAAEC,SAAS,EAAE,GAAGhC;IAC9B,MAAMiC,MAAMvC,MAAMwC,MAAM,CAAc;IACtC,MAAMC,UAAUzC,MAAM0C,WAAW,CAAC,IAAM3B,SAASH,MAAM;QAACA;QAAKG;KAAS;IACtE,MAAM4B,cAAc3C,MAAM0C,WAAW,CAAC,IAAMpB,UAAUV,MAAM;QAACA;QAAKU;KAAQ;IAC1E,MAAMsB,cAAc5C,MAAM0C,WAAW,CAAC,IAAMnB,UAAUX,MAAM;QAACA;QAAKW;KAAQ;IAC1E,MAAMsB,cAAc7C,MAAM0C,WAAW,CAAC,IAAMlB,UAAUZ,MAAM;QAACA;QAAKY;KAAQ;IAE1E,MAAMsB,mBAAmB5B,SAAS,YAAY;IAC9C,MAAM,EAAE6B,YAAY,EAAE,GAAGC,aAAa,GAAG9C;IACzC,MAAM+C,yBAAyB9C,yBAAyB;QACtD4C;QACAG,MAAMJ;IACR;IACA,MAAMK,gBAAgB/C,WAAW4C,aAAa;QAAExB,SAASqB;QAAapB;IAAO;IAE7E,MAAM2B,QAAQ,IAAIC,KAAKC,cAAc,CAACjB,QAAQ;QAC5CkB,SAAS;QACTC,OAAO;QACP5C,KAAK;IACP,GAAG6C,MAAM,CAAC7C;IAEVZ,MAAM0D,SAAS,CAAC;QACd,IAAIrC,WAAWkB,IAAIoB,OAAO,EAAE;YAC1BpB,IAAIoB,OAAO,CAACC,KAAK;QACnB;IACF,GAAG;QAACvC;KAAQ;IAEZ,MAAMwC,UAAU7D,MAAM8D,OAAO,CAAC;QAC5B,IAAI9B,kBAAkB;YACpB,OAAOA,iBAAiBpB;QAC1B;QACA,qBACE,MAACmD;YAAIC,WAAWvD,OAAOwD,SAAS;;8BAC9B,KAACzD;8BAAgBuB,YAAYqB;;8BAC7B,KAACc;oBAAKC,aAAW;8BAAEvD,IAAIwD,OAAO;;;;IAGpC,GAAG;QAACpC;QAAkBpB;QAAKmB;QAAUqB;KAAM;IAE3C,IAAIpC,QAAQ;QACV,qBACE,KAAC+C;YACC7B,MAAMA;YACNmC,iBAAelC;YACf6B,WAAW/D,WAAWQ,OAAOO,MAAM,EAAEc,SAAS,OAAOrB,OAAO6D,KAAK;;IAGvE;IAEA,qBACE,KAAC/D;QACCgE,eAAetE,WACbQ,OAAO+D,IAAI,EACX1C,SAAS,OAAOrB,OAAO6D,KAAK,EAC5BhC,cAAc,SAAS7B,OAAOgE,GAAG,EACjCxB;QAEFf,MAAMA;QACNmC,iBAAelC;QACfuC,WAAWjE,OAAOkE,WAAW;QAC7BC,YAAYnE,OAAOoE,aAAa;QAChCC,WAAW;QACXrC,SAASA;QACTxB,UAAUA;QACV8D,YAAYxC;QACZyC,gBAAgBrC;QAChBsC,gBAAgBrC;QAChBsC,eAAa,OAAOjD,WAAW,WAAWA,SAASA,SAASrB;QAC3D,GAAGwB,SAAS;QACZ,GAAGe,aAAa;kBAEjB,cAAA,KAACY;YACCC,WAAW/D,WACTQ,OAAOoD,OAAO,EACd/B,SAAS,OAAOrB,OAAO6D,KAAK,EAC5BzD,SAASJ,OAAOI,KAAK,EACrBC,YAAY,CAACG,YAAYR,OAAOK,QAAQ,EACxCK,kBAAkBV,OAAOU,cAAc,EACvCC,gBAAgBX,OAAOW,YAAY,EACnCH,YAAYR,OAAOQ,QAAQ,EAC3B,CAACY,aAAapB,OAAO0E,YAAY;sBAGnC,cAAA,KAACpB;gBACCC,WAAW/D,WACTQ,OAAOiB,MAAM,EACbA,UAAUjB,OAAO2E,YAAY,EAC7BzD,wBAAwBlB,OAAOkB,oBAAoB,EACnDC,sBAAsBnB,OAAOmB,kBAAkB;0BAGjD,cAAA,KAACmC;oBAAIC,WAAW/D,WAAWQ,OAAO4E,KAAK,EAAEnE,UAAU,CAACD,YAAYR,OAAO6E,WAAW;8BAC/EzB;;;;;AAMb,GACA;AAEF,IAAI0B,QAAQC,GAAG,CAACC,QAAQ,KAAK,cAAc;IACzCpF,4BAA4BK,aAAa;AAC3C"}