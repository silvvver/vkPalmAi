{"version":3,"sources":["../../../../src/components/Accordion/AccordionContent.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { useCSSKeyframesAnimationController } from '../../lib/animation';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport type { HasRef, HasRootRef } from '../../types';\nimport { AccordionContext } from './AccordionContext';\nimport styles from './Accordion.module.css';\n\nconst CUSTOM_PROPERTY_ACCORDION_CONTENT_HEIGHT = '--vkui_internal--AccordionContent_height';\n\nconst stateClassNames = {\n  enter: styles.inEnter,\n  entering: styles.inEnter,\n  entered: styles.inEntered,\n  exit: styles.inExit,\n  exiting: styles.inExit,\n  exited: styles.inExited,\n};\n\nexport interface AccordionContentProps\n  extends HasRootRef<HTMLDivElement>,\n    HasRef<HTMLDivElement>,\n    React.HTMLAttributes<HTMLDivElement> {}\n\nexport const AccordionContent = ({\n  getRootRef,\n  getRef,\n  className,\n  children,\n  ...restProps\n}: AccordionContentProps) => {\n  const { expanded, labelId, contentId } = React.useContext(AccordionContext);\n\n  const inRef = useExternRef(getRef);\n  const [animationState, animationHandlers] = useCSSKeyframesAnimationController(\n    expanded ? 'enter' : 'exit',\n    undefined,\n    true,\n  );\n\n  useIsomorphicLayoutEffect(() => {\n    const inEl = inRef.current;\n\n    /* istanbul ignore if: невозможный кейс (в SSR вызова этой функции не будет) */\n    if (!inEl) {\n      return;\n    }\n\n    switch (animationState) {\n      case 'enter':\n      case 'exit':\n        inEl.style.setProperty(CUSTOM_PROPERTY_ACCORDION_CONTENT_HEIGHT, `${inEl.scrollHeight}px`);\n        break;\n      case 'entered':\n      case 'exited':\n        inEl.style.removeProperty(CUSTOM_PROPERTY_ACCORDION_CONTENT_HEIGHT);\n        break;\n    }\n  }, [animationState, inRef]);\n\n  return (\n    <div\n      ref={getRootRef}\n      id={contentId}\n      role=\"region\"\n      aria-labelledby={labelId}\n      aria-hidden={!expanded}\n      className={classNames(styles.host, className)}\n      {...restProps}\n    >\n      <div\n        ref={inRef}\n        className={classNames(styles.in, stateClassNames[animationState])}\n        {...animationHandlers}\n      >\n        {children}\n      </div>\n    </div>\n  );\n};\n"],"names":["React","classNames","useExternRef","useCSSKeyframesAnimationController","useIsomorphicLayoutEffect","AccordionContext","styles","CUSTOM_PROPERTY_ACCORDION_CONTENT_HEIGHT","stateClassNames","enter","inEnter","entering","entered","inEntered","exit","inExit","exiting","exited","inExited","AccordionContent","getRootRef","getRef","className","children","restProps","expanded","labelId","contentId","useContext","inRef","animationState","animationHandlers","undefined","inEl","current","style","setProperty","scrollHeight","removeProperty","div","ref","id","role","aria-labelledby","aria-hidden","host","in"],"mappings":"AAAA;;AAEA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,UAAU,QAAQ,kBAAkB;AAC7C,SAASC,YAAY,QAAQ,8BAA2B;AACxD,SAASC,kCAAkC,QAAQ,+BAAsB;AACzE,SAASC,yBAAyB,QAAQ,yCAAsC;AAEhF,SAASC,gBAAgB,QAAQ,wBAAqB;AACtD,OAAOC,YAAY,yBAAyB;AAE5C,MAAMC,2CAA2C;AAEjD,MAAMC,kBAAkB;IACtBC,OAAOH,OAAOI,OAAO;IACrBC,UAAUL,OAAOI,OAAO;IACxBE,SAASN,OAAOO,SAAS;IACzBC,MAAMR,OAAOS,MAAM;IACnBC,SAASV,OAAOS,MAAM;IACtBE,QAAQX,OAAOY,QAAQ;AACzB;AAOA,OAAO,MAAMC,mBAAmB,CAAC,EAC/BC,UAAU,EACVC,MAAM,EACNC,SAAS,EACTC,QAAQ,EACR,GAAGC,WACmB;IACtB,MAAM,EAAEC,QAAQ,EAAEC,OAAO,EAAEC,SAAS,EAAE,GAAG3B,MAAM4B,UAAU,CAACvB;IAE1D,MAAMwB,QAAQ3B,aAAamB;IAC3B,MAAM,CAACS,gBAAgBC,kBAAkB,GAAG5B,mCAC1CsB,WAAW,UAAU,QACrBO,WACA;IAGF5B,0BAA0B;QACxB,MAAM6B,OAAOJ,MAAMK,OAAO;QAE1B,6EAA6E,GAC7E,IAAI,CAACD,MAAM;YACT;QACF;QAEA,OAAQH;YACN,KAAK;YACL,KAAK;gBACHG,KAAKE,KAAK,CAACC,WAAW,CAAC7B,0CAA0C,GAAG0B,KAAKI,YAAY,CAAC,EAAE,CAAC;gBACzF;YACF,KAAK;YACL,KAAK;gBACHJ,KAAKE,KAAK,CAACG,cAAc,CAAC/B;gBAC1B;QACJ;IACF,GAAG;QAACuB;QAAgBD;KAAM;IAE1B,qBACE,KAACU;QACCC,KAAKpB;QACLqB,IAAId;QACJe,MAAK;QACLC,mBAAiBjB;QACjBkB,eAAa,CAACnB;QACdH,WAAWrB,WAAWK,OAAOuC,IAAI,EAAEvB;QAClC,GAAGE,SAAS;kBAEb,cAAA,KAACe;YACCC,KAAKX;YACLP,WAAWrB,WAAWK,OAAOwC,EAAE,EAAEtC,eAAe,CAACsB,eAAe;YAC/D,GAAGC,iBAAiB;sBAEpBR;;;AAIT,EAAE"}