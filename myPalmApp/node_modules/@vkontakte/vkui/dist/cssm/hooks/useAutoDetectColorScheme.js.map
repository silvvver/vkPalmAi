{"version":3,"sources":["../../../src/hooks/useAutoDetectColorScheme.ts"],"sourcesContent":["import * as React from 'react';\nimport { noop } from '@vkontakte/vkjs';\nimport { ColorScheme, type ColorSchemeType } from '../lib/colorScheme';\nimport { useDOM } from '../lib/dom';\nimport { matchMediaListAddListener, matchMediaListRemoveListener } from '../lib/matchMedia';\nimport { useIsomorphicLayoutEffect } from '../lib/useIsomorphicLayoutEffect';\n\n/**\n * @private\n */\nexport const useAutoDetectColorScheme = (colorSchemeProp?: ColorSchemeType): ColorSchemeType => {\n  const { window } = useDOM();\n\n  const [colorScheme, setColorScheme] = React.useState<ColorSchemeType>(\n    colorSchemeProp || ColorScheme.LIGHT,\n  );\n\n  useIsomorphicLayoutEffect(() => {\n    if (colorSchemeProp) {\n      setColorScheme(colorSchemeProp);\n      return noop;\n    }\n\n    const mediaQuery = window ? window.matchMedia('(prefers-color-scheme: dark)') : undefined;\n\n    if (!mediaQuery) {\n      return noop;\n    }\n\n    const check = (event: MediaQueryList | MediaQueryListEvent) => {\n      // eslint-disable-next-line no-restricted-properties\n      setColorScheme(event.matches ? ColorScheme.DARK : ColorScheme.LIGHT);\n    };\n    check(mediaQuery);\n    matchMediaListAddListener(mediaQuery, check);\n    return () => matchMediaListRemoveListener(mediaQuery, check);\n  }, [window, colorSchemeProp]);\n\n  return colorScheme;\n};\n"],"names":["React","noop","ColorScheme","useDOM","matchMediaListAddListener","matchMediaListRemoveListener","useIsomorphicLayoutEffect","useAutoDetectColorScheme","colorSchemeProp","window","colorScheme","setColorScheme","useState","LIGHT","mediaQuery","matchMedia","undefined","check","event","matches","DARK"],"mappings":"AAAA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,IAAI,QAAQ,kBAAkB;AACvC,SAASC,WAAW,QAA8B,8BAAqB;AACvE,SAASC,MAAM,QAAQ,gBAAa;AACpC,SAASC,yBAAyB,EAAEC,4BAA4B,QAAQ,uBAAoB;AAC5F,SAASC,yBAAyB,QAAQ,sCAAmC;AAE7E;;CAEC,GACD,OAAO,MAAMC,2BAA2B,CAACC;IACvC,MAAM,EAAEC,MAAM,EAAE,GAAGN;IAEnB,MAAM,CAACO,aAAaC,eAAe,GAAGX,MAAMY,QAAQ,CAClDJ,mBAAmBN,YAAYW,KAAK;IAGtCP,0BAA0B;QACxB,IAAIE,iBAAiB;YACnBG,eAAeH;YACf,OAAOP;QACT;QAEA,MAAMa,aAAaL,SAASA,OAAOM,UAAU,CAAC,kCAAkCC;QAEhF,IAAI,CAACF,YAAY;YACf,OAAOb;QACT;QAEA,MAAMgB,QAAQ,CAACC;YACb,oDAAoD;YACpDP,eAAeO,MAAMC,OAAO,GAAGjB,YAAYkB,IAAI,GAAGlB,YAAYW,KAAK;QACrE;QACAI,MAAMH;QACNV,0BAA0BU,YAAYG;QACtC,OAAO,IAAMZ,6BAA6BS,YAAYG;IACxD,GAAG;QAACR;QAAQD;KAAgB;IAE5B,OAAOE;AACT,EAAE"}