{"version":3,"sources":["../../../src/components/DateInput/hooks.ts"],"sourcesContent":["/* eslint-disable jsdoc/require-jsdoc */\n\nimport * as React from 'react';\nimport { convertDateFromTimeZone, convertDateToTimeZone } from '../../lib/date';\n\ninterface UseDateInputValueOptions {\n  value?: Date | null;\n  defaultValue?: Date | null;\n  onChange?: (value?: Date) => void;\n  timezone?: string;\n}\n\nexport interface UseDateInputValueReturn {\n  value?: Date | null;\n  updateValue: (v: Date) => Date;\n  setInternalValue: (v?: Date | null) => void;\n  getLastUpdatedValue: () => Date | null | undefined;\n  clearValue: () => void;\n}\n\nconst _convertDateToTimeZone = (date: Date | null, timezone?: string): Date | null => {\n  return convertDateToTimeZone(date, timezone) || null;\n};\n\nconst _convertDateFromTimeZone = (date: Date, timezone?: string): Date => {\n  return convertDateFromTimeZone(date, timezone) as Date;\n};\n\nconst getStateValue = (\n  defaultStateValue: Date | null,\n  value?: Date | null,\n  defaultValue?: Date | null,\n  timezone?: string,\n): Date | null => {\n  if (value !== undefined) {\n    return _convertDateToTimeZone(value, timezone);\n  }\n  if (defaultValue !== undefined) {\n    return _convertDateToTimeZone(defaultValue, timezone);\n  }\n  return _convertDateToTimeZone(defaultStateValue, timezone);\n};\n\nexport const useDateInputValue = ({\n  value,\n  defaultValue,\n  onChange,\n  timezone,\n}: UseDateInputValueOptions): UseDateInputValueReturn => {\n  const [internalValue, setInternalValue] = React.useState<Date | null | undefined>(\n    getStateValue(null, value, defaultValue, timezone),\n  );\n  const lastUpdatedValueRef = React.useRef<Date | null | undefined>(\n    getStateValue(null, value, defaultValue, timezone),\n  );\n\n  const isControlled = value !== undefined;\n\n  React.useEffect(() => {\n    if (isControlled) {\n      const newInternalValue = _convertDateToTimeZone(value, timezone);\n      setInternalValue(newInternalValue);\n      lastUpdatedValueRef.current = newInternalValue;\n    }\n  }, [isControlled, timezone, value]);\n\n  const getLastUpdatedValue = React.useCallback(() => lastUpdatedValueRef.current, []);\n\n  const updateValue = React.useCallback(\n    (newValue: Date) => {\n      if (!isControlled) {\n        setInternalValue(newValue);\n        lastUpdatedValueRef.current = newValue;\n      }\n      const originalTimezoneValue = _convertDateFromTimeZone(newValue, timezone);\n      onChange?.(originalTimezoneValue);\n      return originalTimezoneValue;\n    },\n    [isControlled, onChange, timezone],\n  );\n\n  const clearValue = () => {\n    setInternalValue(null);\n    lastUpdatedValueRef.current = null;\n    onChange?.(undefined);\n  };\n\n  return {\n    value: internalValue,\n    updateValue,\n    setInternalValue,\n    getLastUpdatedValue,\n    clearValue,\n  };\n};\n"],"names":["React","convertDateFromTimeZone","convertDateToTimeZone","_convertDateToTimeZone","date","timezone","_convertDateFromTimeZone","getStateValue","defaultStateValue","value","defaultValue","undefined","useDateInputValue","onChange","internalValue","setInternalValue","useState","lastUpdatedValueRef","useRef","isControlled","useEffect","newInternalValue","current","getLastUpdatedValue","useCallback","updateValue","newValue","originalTimezoneValue","clearValue"],"mappings":"AAAA,sCAAsC,GAEtC,YAAYA,WAAW,QAAQ;AAC/B,SAASC,uBAAuB,EAAEC,qBAAqB,QAAQ,oBAAiB;AAiBhF,MAAMC,yBAAyB,CAACC,MAAmBC;IACjD,OAAOH,sBAAsBE,MAAMC,aAAa;AAClD;AAEA,MAAMC,2BAA2B,CAACF,MAAYC;IAC5C,OAAOJ,wBAAwBG,MAAMC;AACvC;AAEA,MAAME,gBAAgB,CACpBC,mBACAC,OACAC,cACAL;IAEA,IAAII,UAAUE,WAAW;QACvB,OAAOR,uBAAuBM,OAAOJ;IACvC;IACA,IAAIK,iBAAiBC,WAAW;QAC9B,OAAOR,uBAAuBO,cAAcL;IAC9C;IACA,OAAOF,uBAAuBK,mBAAmBH;AACnD;AAEA,OAAO,MAAMO,oBAAoB,CAAC,EAChCH,KAAK,EACLC,YAAY,EACZG,QAAQ,EACRR,QAAQ,EACiB;IACzB,MAAM,CAACS,eAAeC,iBAAiB,GAAGf,MAAMgB,QAAQ,CACtDT,cAAc,MAAME,OAAOC,cAAcL;IAE3C,MAAMY,sBAAsBjB,MAAMkB,MAAM,CACtCX,cAAc,MAAME,OAAOC,cAAcL;IAG3C,MAAMc,eAAeV,UAAUE;IAE/BX,MAAMoB,SAAS,CAAC;QACd,IAAID,cAAc;YAChB,MAAME,mBAAmBlB,uBAAuBM,OAAOJ;YACvDU,iBAAiBM;YACjBJ,oBAAoBK,OAAO,GAAGD;QAChC;IACF,GAAG;QAACF;QAAcd;QAAUI;KAAM;IAElC,MAAMc,sBAAsBvB,MAAMwB,WAAW,CAAC,IAAMP,oBAAoBK,OAAO,EAAE,EAAE;IAEnF,MAAMG,cAAczB,MAAMwB,WAAW,CACnC,CAACE;QACC,IAAI,CAACP,cAAc;YACjBJ,iBAAiBW;YACjBT,oBAAoBK,OAAO,GAAGI;QAChC;QACA,MAAMC,wBAAwBrB,yBAAyBoB,UAAUrB;QACjEQ,qBAAAA,+BAAAA,SAAWc;QACX,OAAOA;IACT,GACA;QAACR;QAAcN;QAAUR;KAAS;IAGpC,MAAMuB,aAAa;QACjBb,iBAAiB;QACjBE,oBAAoBK,OAAO,GAAG;QAC9BT,qBAAAA,+BAAAA,SAAWF;IACb;IAEA,OAAO;QACLF,OAAOK;QACPW;QACAV;QACAQ;QACAK;IACF;AACF,EAAE"}